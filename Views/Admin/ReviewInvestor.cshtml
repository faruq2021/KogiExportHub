@model Investor
@{
    ViewData["Title"] = "Review Investor";
}

<div class="container-fluid mt-4">
    <h1 class="mb-4"><i class="bi bi-eye"></i> Review Investor: @Model.CompanyName</h1>
    
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5>Investor Details</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-3">Company Name:</dt>
                        <dd class="col-sm-9">@Model.CompanyName</dd>
                        
                        <dt class="col-sm-3">Contact Person:</dt>
                        <dd class="col-sm-9">@Model.ContactPerson</dd>
                        
                        <dt class="col-sm-3">Email:</dt>
                        <dd class="col-sm-9">@Model.Email</dd>
                        
                        <dt class="col-sm-3">Phone:</dt>
                        <dd class="col-sm-9">@Model.Phone</dd>
                        
                        <dt class="col-sm-3">Country:</dt>
                        <dd class="col-sm-9">@Model.Country</dd>
                        
                        <dt class="col-sm-3">Investment Capacity:</dt>
                        <dd class="col-sm-9">â‚¦@Model.InvestmentCapacity.ToString("N0")</dd>
                        
                        <dt class="col-sm-3">Registration Date:</dt>
                        <dd class="col-sm-9">@Model.RegistrationDate.ToString("MMM dd, yyyy")</dd>
                        
                        <dt class="col-sm-3">Status:</dt>
                        <dd class="col-sm-9">
                            @if (Model.VerificationStatus == "Verified")
                            {
                                <span class="badge bg-success">Verified</span>
                            }
                            else if (Model.VerificationStatus == "Pending")
                            {
                                <span class="badge bg-warning">Pending</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">Rejected</span>
                            }
                        </dd>
                    </dl>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            @if (Model.VerificationStatus == "Pending")
            {
                <div class="card">
                    <div class="card-header">
                        <h5>Actions</h5>
                    </div>
                    <div class="card-body">
                        <button type="button" class="btn btn-success w-100 mb-2" onclick="approveInvestor(@Model.Id, '@Model.CompanyName')">
                            <i class="bi bi-check"></i> Approve Investor
                        </button>
                        <button type="button" class="btn btn-danger w-100" onclick="rejectInvestor(@Model.Id, '@Model.CompanyName')">
                            <i class="bi bi-x"></i> Reject Investor
                        </button>
                    </div>
                </div>
            }
        </div>
    </div>
    
    <div class="mt-3">
        <a asp-action="InvestorManagement" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to Investor Management
        </a>
    </div>

<!-- Approval Modal -->
<div class="modal fade" id="approvalModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Approve Investor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="approvalForm" method="post">
                <div class="modal-body">
                    <p>Are you sure you want to approve <strong id="approvalCompanyName"></strong>?</p>
                    <div class="mb-3">
                        <label for="adminComments" class="form-label">Admin Comments (Optional)</label>
                        <textarea class="form-control" id="adminComments" name="adminComments" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success">Approve Investor</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Rejection Modal -->
<div class="modal fade" id="rejectionModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Reject Investor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="rejectionForm" method="post">
                <div class="modal-body">
                    <p>Are you sure you want to reject <strong id="rejectionCompanyName"></strong>?</p>
                    <div class="mb-3">
                        <label for="rejectionReason" class="form-label">Rejection Reason *</label>
                        <textarea class="form-control" id="rejectionReason" name="rejectionReason" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Reject Investor</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function approveInvestor(investorId, companyName) {
            document.getElementById('approvalCompanyName').textContent = companyName;
            document.getElementById('approvalForm').action = '/Admin/ApproveInvestorAction/' + investorId;
            new bootstrap.Modal(document.getElementById('approvalModal')).show();
        }

        function rejectInvestor(investorId, companyName) {
            document.getElementById('rejectionCompanyName').textContent = companyName;
            document.getElementById('rejectionForm').action = '/Admin/RejectInvestorAction/' + investorId;
            new bootstrap.Modal(document.getElementById('rejectionModal')).show();
        }
    </script>
}